function l(e,t,n,o){d();var l=document.getElementById("avatarDiv"),r=document.getElementById("nameDiv"),i=document.getElementById("statDiv");document.getElementById("errorDiv");l.innerHTML="<img src='"+e.profile_pic_url+"'/>",r.innerHTML="<h5><a href='https://www.instagram.com/"+e.username+"/' target='_blank'>@"+e.username+"</a> ["+e.full_name+"]</h5>",null!=t&&null!=n&&null!=o&&(i.innerHTML="followers: <b>"+t.length+"</b></br>following: <b>"+n.length+"</b></br>reciprocal: <b>"+o+"</b></br></br></br>")}function r(){d();var e=document.getElementById("avatarDiv"),t=document.getElementById("nameDiv"),n=document.getElementById("statDiv");e.innerHTML="<img src='img/useravatar.svg' width='150' height='150'/>",t.innerHTML="",n.innerHTML=""}function i(e){d(),null==e&&(e="Scanning now .."),document.getElementById("statDiv").innerHTML=e}function a(e){document.getElementById("errorDiv").innerHTML=e}function d(){document.getElementById("errorDiv").innerHTML=""}function s(e){var t=document.getElementById("contentDiv2");t.innerHTML="<div style='width:100%; text-align:center'><h5><b>Your Followers</b></h5></div>";for(var n="",o=0;o<e.length;o++)n=function(e,t,n){var o="no",l="notfollowed";t.node.followed_by_viewer&&(o="yes",l="");return e+="<tr id='followersRow"+t.node.id+"' class='"+l+"'>",e+="<td>"+(n+1)+"</td>",e+="<td><img style='width: 30px; height: 30px;' src='"+t.node.profile_pic_url+"'></td>",e+="<td><a href='https://www.instagram.com/"+t.node.username+"/' target='_blank'>"+t.node.username+"</a></td>",e+="<td>"+t.node.full_name+"</td>",e+="<td>"+o+"&nbsp;&nbsp;</td>",e+="</tr>"}(n,e[o],o);t.innerHTML+="<table class='highlight'><thead><tr><th style='width:10%;'>№</th><th style='width:10%;'>&nbsp;</th><th style='width:25%;'>Username</th><th style='width:30%;'>Full Name</th><th style='width:15%;'>You Follow Back</th></tr></thead><tbody>"+n+"</tbody></table>"}function c(e){var t=document.getElementById("contentDiv1");t.innerHTML="<div style='width:100%; text-align:center'><h5><b>Your Follows</b></h5></div>";for(var n="",o=0;o<e.length;o++)n=function(e,t,n){var o="yes",l="";{null!=t.node.backfollow&&1!=t.node.backfollow&&(o="no",l="notfollowed")}return e+="<tr id='followingsRow"+t.node.id+"' class='"+l+"'>",e+="<td style=''>"+(n+1)+"</td>",e+="<td style=''><img style='width: 30px; height: 30px;' src='"+t.node.profile_pic_url+"'></td>",e+="<td style=''><a href='https://www.instagram.com/"+t.node.username+"/' target='_blank'>"+t.node.username+"</a></td>",e+="<td style=''>"+t.node.full_name+"</td>",e+="<td style=''>"+o+"&nbsp;&nbsp;",e+="</div>"}(n,e[o],o);t.innerHTML+="<table class='highlight'><thead><tr><th style='width:5%;'>№</th><th style='width:10%;'>&nbsp;</th><th style='width:25%;'>Username</th><th style='width:30%;'>Full Name</th><th style='width:20%;'>Follows You Back</th></tr></thead><tbody>"+n+"</tbody></table>"}function n(){document.getElementById("contentDiv1").innerHTML="",document.getElementById("contentDiv2").innerHTML="",t()}function t(){r(),i(),chrome.runtime.sendMessage({type:"start-scan",scanId:""},function(e){})}chrome.extension.onMessage.addListener(function(e,t,n){var o;n(),"scanStepFinished"==e.action?"main"==e.type?l(e.viewer):"followers"==e.type?(l(e.viewer),function(e,t){var n=e.length;percentage=Math.floor(n/900*100);var o="<p>Scanning followers: <b>"+e.length+" / "+t+"</b> [ "+e[e.length-1].node.full_name+" ]</p>";i(o+="<div id='progressBar' style='width:100%; background-color:#ddd;'><div id='progressBarInner' style='width:"+percentage+"%; height: 30px; background-color:#4CAF50; text-align:center; line-height:30px; color:white;'>"+percentage+"%</div></div>")}(e.followers,e.followersCount)):"followings"==e.type?(l(e.viewer),function(e,t){var n=e.length;percentage=Math.floor((600+n)/900*100);var o="<p>Scanning followings: <b>"+e.length+" / "+t+"</b> [ "+e[e.length-1].node.full_name+" ]</p>";i(o+="<div id='progressBar' style='width:100%; background-color:#ddd;'><div id='progressBarInner' style='width:"+percentage+"%; height: 30px; background-color:#4CAF50; text-align:center; line-height:30px; color:white;'>"+percentage+"%</div></div>")}(e.followings,e.followsCount)):"count"==e.type?(l(e.viewer,e.followers,e.followings,e.reciprocal),s(e.followers),c(e.followings)):e.type:"error"==e.action&&("instagramApiTimeout"==e.type?a("Instagram servers don't like us to be that fast! Please make yourself some coffee, we gonna make a break for some minutes."):"instagramNotAuthorized"==e.type?(r(),o=document.getElementById("modalAuthorize"),M.Modal.getInstance(o).open()):"httpRequestError"==e.type&&a("Internet connection error, keep trying to reconnect"))}),chrome.runtime.sendMessage({type:"get-scan-data"},function(e){null!=e.scanId&&0==e.scanId?null!=e.scanId&&null!=e.viewer&&null!=e.followers&&null!=e.followings&&null!=e.reciprocal?(l(e.viewer,e.followers,e.followings,e.reciprocal),s(e.followers),c(e.followings)):t():1300<(new Date).getTime()-e.lastScanActionTime&&t()});var e,o=document.querySelectorAll(".modal");M.Modal.init(o);(e=document.getElementById("rescanButton")).classList.remove("disabled"),e.addEventListener("click",function(e){chrome.runtime.sendMessage({type:"get-scan-data"},function(e){var t;null!=e.scanId&&0<e.scanId?(t=document.getElementById("modalRescan"),M.Modal.getInstance(t).open()):n()})}),document.getElementById("rescanAnywayButton").addEventListener("click",function(e){n()});